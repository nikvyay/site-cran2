var productData = [
    {
        "Category": "Cпецтехника",
        "CategoryID": "special-equipment",
        "CategoryLink": "catalog.html?special-equipment#1",
        "Products": [
            {
                "ID": 1,
                "Name": "Экскаватор погрузчик MST M542",
                "URLImage": "file/category-special-equipment-1.jpg",
                "Category": "Экскаваторы погрузчики",
                "TTX1": "Мощность двигателя: 101 л.с.",
                "TTX2": "Экскаваторный ковш: 0.26 м",
                "Brand": "MST (Турция)",
                "Count": 1000,
                "Price": 8211650
            },
            {
                "ID": 2,
                "Name": "Экскаватор погрузчик MST M642 Plus",
                "URLImage": "file/category-special-equipment-2.jpg",
                "Category": "Экскаваторы погрузчики",
                "TTX1": "Мощность двигателя: 101 л.с.",
                "TTX2": "Экскаваторный ковш: 0.26 м",
                "Brand": "MST (Турция)",
                "Count": 1000,
                "Price": 9439849
            },
            {
                "ID": 3,
                "Name": "Трактор-погрузчик ПБТК-764 СТАНИСЛАВ",
                "URLImage": "file/category-special-equipment-3.jpg",
                "Category": "Трактора",
                "TTX1": "Мощность двигателя: 240-330 л.с.",
                "TTX2": "Масса: 18 т Базовый трактор",
                "Brand": "MST (Турция)",
                "Count": 1000,
                "Price": 13750000
            },
            {
                "ID": 4,
                "Name": "Самосвал Shacman F3000 8х4 SX3316DV366",
                "URLImage": "file/category-special-equipment-4.jpg",
                "Category": "Самосвалы",
                "TTX1": "Грузоподъемность: - кг",
                "TTX2": "Объем кузова: - м",
                "Brand": "Shacman",
                "Count": 1000,
                "Price": 4750000
            },
            {
                "ID": 5,
                "Name": "Экскаватор погрузчик LEIST GROSS 788",
                "URLImage": "file/category-special-equipment-5.jpg",
                "Category": "Экскаваторы погрузчики",
                "TTX1": "Мощность двигателя: 100 л.с.",
                "TTX2": "Экскаваторный ковш: 0.3 м3",
                "Brand": "Leist Gross (Китай)",
                "Count": 1000,
                "Price": 7000000
            },
            {
                "ID": 6,
                "Name": "Бульдозер Б10М - Двигатель Д180 К/Р 1 2021",
                "URLImage": "file/category-special-equipment-6.jpg",
                "Category": "Бульдозеры",
                "TTX1": "Масса: 19,5 т",
                "TTX2": "Мощность двигателя: 180 л.с.",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 7000000
            },
            {
                "ID": 7,
                "Name": "Седельный тягач FAW JH6 ORYX4",
                "URLImage": "file/category-special-equipment-7.jpg",
                "Category": "Тягачи",
                "TTX1": " ",
                "TTX2": " ",
                "Brand": "FAW (Китай)",
                "Count": 1000,
                "Price": 9600000
            },
            {
                "ID": 8,
                "Name": "Самосвал МАЗ 6501С9-8520-005",
                "URLImage": "file/category-special-equipment-8.jpg",
                "Category": "Самосвалы",
                "TTX1": "Грузоподъемность: 19500 кг",
                "TTX2": "Объем кузова: - м3",
                "Brand": "МАЗ",
                "Count": 1000,
                "Price": 9439849
            },
            {
                "ID": 9,
                "Name": "Экскаватор гусеничный JCB JS 330",
                "URLImage": "file/category-special-equipment-9.jpg",
                "Category": "Гусеничные экскаваторы",
                "TTX1": "Мощность: 285 л.с.",
                "TTX2": "Масса: 33,7 тонн",
                "Brand": "JCB (Великобритания)",
                "Count": 1000,
                "Price": 9439849
            },
            {
                "ID": 10,
                "Name": "Экскаватор гусеничный JCB JS 130",
                "URLImage": "file/category-special-equipment-10.jpg",
                "Category": "Гусеничные экскаваторы",
                "TTX1": "Мощность: 100,6 л.с.",
                "TTX2": "Масса: 13,6 т",
                "Brand": "JCB (Великобритания)",
                "Count": 1000,
                "Price": 9474980 
            },
            {
                "ID": 11,
                "Name": "Экскаватор гусеничный JCB-JS 190",
                "URLImage": "file/category-special-equipment-11.jpg",
                "Category": "Гусеничные экскаваторы",
                "TTX1": "Мощность: 131,8 л.с.",
                "TTX2": "Масса: 19,9 т",
                "Brand": "JCB (Великобритания)",
                "Count": 1000,
                "Price": 13750000
            }
        ]
    },
    {
        "Category": "Навесное оборудование",
        "CategoryID": "special-attachments",
        "CategoryLink": "catalog.html?special-attachments#1",
        "Products": [
            {
                "ID": 21,
                "Name": "Дробильный ковш MB BF90.3 S4",
                "URLImage": "file/attachment-1.jpg",
                "Category": "Дробильные ковши",
                "TTX1": "Рекомендуемая машина —",
                "TTX2": "экскаватор",
                "Brand": "MST (Турция)",
                "Count": 1000,
                "Price": 211650
            },
            {
                "ID": 22,
                "Name": "Погрузчик на МТЗ Турс-2000-0 без джойстика",
                "URLImage": "file/attachment-2.jpg",
                "Category": "Погрузчики",
                "TTX1": "Рекомендуемая машина —",
                "TTX2": "экскаватор",
                "Brand": "MST (Турция)",
                "Count": 1000,
                "Price": 325900
            },
            {
                "ID": 23,
                "Name": "Рециклер асфальтобетона НВ-1",
                "URLImage": "file/attachment-3.jpg",
                "Category": "Рециклеры",
                "TTX1": "Объем: 0,4 куб.м.",
                "TTX2": " ",
                "Brand": "Ticab (Польша)",
                "Count": 1000,
                "Price": 325900
            },
            {
                "ID": 24,
                "Name": "Рециклер асфальтобетона RA-800",
                "URLImage": "file/attachment-4.jpg",
                "Category": "Рециклеры",
                "TTX1": "Производительность:",
                "TTX2": "1800-2100 кг",
                "Brand": "Ticab (Польша)",
                "Count": 1000,
                "Price": 2234097
            }
        ]
    },
    {
        "Category": "Дорожное оснащение",
        "CategoryID": "road-equipment",
        "CategoryLink": "catalog.html?road-equipment#1",
        "Products": [
            {
                "ID": 31,
                "Name": "Знак 2. 5 Движение без остановки запрещено",
                "URLImage": "file/road-equipment-1.jpg",
                "Category": "Дорожные знаки",
                "TTX1": "Типоразмеры: 1, 2, 3",
                "TTX2": "Тип пленки: А, Б, В",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 1050
            },            {
                "ID": 32,
                "Name": "Знак 3.2 Движение запрещено",
                "URLImage": "file/road-equipment-2.jpg",
                "Category": "Дорожные знаки",
                "TTX1": "Типоразмеры: 1, 2, 3",
                "TTX2": "Тип пленки: А, Б, В",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 1050
            },            {
                "ID": 33,
                "Name": "Дорожный знак светодиодный 900 4.2.3 Эконом",
                "URLImage": "file/road-equipment-3.jpg",
                "Category": "Дорожные знаки",
                "TTX1": "Типоразмеры: 1, 2, 3",
                "TTX2": "Тип пленки: А, Б, В",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 9500
            },            {
                "ID": 34,
                "Name": "Знак 2. 2 Конец главной дороги",
                "URLImage": "file/road-equipment-4.jpg",
                "Category": "Дорожные знаки",
                "TTX1": "Типоразмеры: 1, 2, 3",
                "TTX2": "Тип пленки: А, Б, В",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 1000
            }
        ]
    },
    {
        "Category": "Материалы",
        "CategoryID": "materials",
        "CategoryLink": "catalog.html?materials#1",
        "Products": [
            {
                "ID": 41,
                "Name": "Дорожная краска АК-511 «Спринтер» цветная",
                "URLImage": "file/material-1.jpg",
                "Category": "Материалы для разметки",
                "TTX1": "Долгосохнущая краска",
                "TTX2": " ",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 6190
            },
            {
                "ID": 42,
                "Name": "Дорожная краска АК-511 «Спринтер» белая",
                "URLImage": "file/material-2.jpg",
                "Category": "Материалы для разметки",
                "TTX1": "Долгосохнущая краска",
                "TTX2": " ",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 5600
            },
            {
                "ID": 43,
                "Name": "Дорожная краска АК-505 \"Road Expert\" белая",
                "URLImage": "file/material-3.jpg",
                "Category": "Дорожная краска",
                "TTX1": "Долгосохнущая краска",
                "TTX2": " ",
                "Brand": "Велес (Россия)",
                "Count": 1000,
                "Price": 11600
            }
        ]
    }
]; 

function productToCard(id, urlImage, name, price) {
    let quantity = 1;
    return {
        getID() {
            return id;
        },
        getUrlImage() {
            return urlImage;
        },
        getName() {
            return name;
        },
        getQuantity() {
            return quantity;
        },
        getPrice() {
            return price;
        },
        getCost() {
            console.log(price * quantity)
            return price * quantity;
        },
        setUrl(newUrl) {
            url = newUrl;
        },
        setName(newName) {
            name = newName;
        },
        setQuantity(newQuantity) {
            quantity = newQuantity;
        },
        setPrice(newPrice) {
            price = newPrice;
        },
        toJSON() {
            const cost = this.getCost();
            return JSON.stringify({
                id,
                urlImage,
                name,
                quantity,
                price,
                cost
            });
        },
        fromJSON(json) {
            const data = JSON.parse(json);
            const product = productToCard(data.id, data.urlImage, data.name, data.price);
            product.setQuantity(data.quantity);
            return product;
        }
    };
}

function createSpecialEquipment(ID, name, URLImage, category, TTX1, TTX2, brand, count, price) {
    return {
        getName() {
            return name;
        },
        getTTX1() {
            return TTX1;
        },
        getTTX2() {
            return TTX2;
        },
        getBrand() {
            return brand;
        },
        getID() {
            return ID;
        },
        getCount() {
            return count;
        },
        getURLImage() {
            return URLImage;
        },
        getCategory() {
            return category;
        },
        getPrice() {
            return price;
        },
        getQuantity() {
            return quantity;
        },
        getCost() {
            return price * quantity;
        },
        setCount(newCount) {
            count = newCount;
        },
        setQuantity(newQuantity) {
            quantity = newQuantity;
        },
        setURLImage(newURLImage) {
            URLImage = newURLImage;
        },
        setPrice(newPrice) {
            price = newPrice;
        },
        getProductToCard() {
            return productToCard(ID, URLImage, name, price);
        },
        addToCard(count) {
            console.log('asdas', count);
            var se1 = this.getProductToCard();
            se1.setQuantity(count);
            this._addToCard(se1);
        },
        _addToCard(data) {
            var item = JSON.parse(localStorage.getItem(data.getID()));
            if (item != null) {
                console.log("asda", item)
                if (data.getCount() > data.getQuantity() + parseInt(item.quantity)){
                    data.setQuantity(data.getCount());
                }
                else {
                    data.setQuantity(data.getQuantity() + parseInt(item.quantity));
                }
            }
            localStorage.setItem(data.getID(), data.toJSON());
            console.log(data.toJSON())
        }
    };
}

function renderCardRowContainer() {
    var row = document.createElement("div");
    row.className = "row justify-content-center";
    return row;
}

function renderCard(product) {
    card = document.createElement("div");
    card.className = "card main-card";

    var cardBody = document.createElement("div");
    cardBody.className = "card-body main-card-body";

    var image = document.createElement("img");
    image.src = product.getURLImage();
    image.className = "card-img-top main-card-img";
    image.setAttribute("data-bs-toggle", "modal");
    image.setAttribute("data-bs-target", "#modal-" + product.getID());

    var category = document.createElement("span");
    category.className = "main-card-category";
    category.innerHTML = product.getCategory();

    var nameLink = document.createElement("a");
    nameLink.href = "product.html?" + product.getID();
    nameLink.className = "text-black main-card-name";

    var name = document.createElement("h5");
    name.innerHTML = product.getName();
    nameLink.appendChild(name);

    var ttx = document.createElement("div");
    ttx.className = "main-card-ttx";

    var ttx1 = document.createElement("p");
    ttx1.innerHTML = product.getTTX1();

    var ttx2 = document.createElement("p");
    ttx2.innerHTML = product.getTTX2();

    ttx.appendChild(ttx1);
    ttx.appendChild(ttx2);

    var price = document.createElement("span");
    price.className = "main-card-price";
    price.innerHTML = formatPrice(product.getPrice());

    cardBody.appendChild(image);
    cardBody.appendChild(category);
    cardBody.appendChild(nameLink);
    cardBody.appendChild(ttx);
    cardBody.appendChild(price);

    card.appendChild(cardBody);

    return card;
}

function renderModal(product) {
    const modalContainer = document.createElement('div');
    modalContainer.classList.add('modal', 'fade');
    modalContainer.id = "modal-" + product.getID();
    modalContainer.tabIndex = '-1';
    modalContainer.setAttribute('aria-labelledby', 'exampleModalLabel');
    modalContainer.setAttribute('aria-hidden', 'true');

    const modalDialog = document.createElement('div');
    modalDialog.classList.add('modal-dialog', 'main-modal');

    const modalContent = document.createElement('div');
    modalContent.classList.add('modal-content', 'main-modal-content', 'p-3');

    const modalContentContainer = document.createElement('div');
    modalContentContainer.classList.add('main-modal-content-contaiter');

    const modalContent1 = document.createElement('div');
    modalContent1.classList.add('main-modal-content-1');

    const modalImage = document.createElement('img');
    modalImage.src = product.getURLImage();
    modalImage.classList.add('modal-main-img');
    modalContent1.appendChild(modalImage);

    const modalContent2 = document.createElement('div');
    modalContent2.classList.add('main-modal-content-2');

    const modalHeading = document.createElement('h2');
    modalHeading.textContent = product.getName();
    modalContent2.appendChild(modalHeading);

    const modalPrice = document.createElement('p');
    modalPrice.classList.add('main-modal-price');
    modalPrice.textContent = formatPrice(product.getPrice());
    modalContent2.appendChild(modalPrice);

    const modalTtxContainer = document.createElement('div');
    modalTtxContainer.classList.add('modal-main-ttx-container');

    const modalTtx1 = document.createElement('div');
    modalTtx1.classList.add('modal-main-ttx');

    const modalTtxTitle1 = document.createElement('h6');
    modalTtxTitle1.classList.add('modal-main-ttx-title');
    modalTtxTitle1.textContent = 'Характеристики';
    modalTtx1.appendChild(modalTtxTitle1);

    const modalTtxText1 = document.createElement('div');
    modalTtxText1.classList.add('modal-main-ttx-text');
    modalTtxText1.textContent = product.getTTX1();
    modalTtx1.appendChild(modalTtxText1);

    const modalTtxText2 = document.createElement('div');
    modalTtxText2.classList.add('modal-main-ttx-text');
    modalTtxText2.textContent = product.getTTX2();
    modalTtx1.appendChild(modalTtxText2);


    const modalTtx2 = document.createElement('div');
    modalTtx2.classList.add('modal-main-ttx');

    const modalTtxTitle3 = document.createElement('h6');
    modalTtxTitle3.classList.add('modal-main-ttx-title');
    modalTtxTitle3.textContent = 'Бренд';
    modalTtx2.appendChild(modalTtxTitle3);

    const modalTtxText3 = document.createElement('div');
    modalTtxText3.classList.add('modal-main-ttx-text');
    modalTtxText3.textContent = product.getBrand();
    modalTtx2.appendChild(modalTtxText3);

    

    const modalTtx3 = document.createElement('div');
    modalTtx3.classList.add('modal-main-ttx');

    const modalTtxTitle4 = document.createElement('h6');
    modalTtxTitle4.classList.add('modal-main-ttx-title');
    modalTtxTitle4.textContent = 'Код товара';
    modalTtx3.appendChild(modalTtxTitle4);

    const modalTtxTitle5 = document.createElement('div');
    modalTtxTitle5.classList.add('modal-main-ttx-text');
    modalTtxTitle5.textContent = "#"+product.getID();
    modalTtx3.appendChild(modalTtxTitle5);



    const modalTtx4 = document.createElement('div');
    modalTtx4.classList.add('modal-main-ttx');

    const modalTtxTitle6 = document.createElement('h6');
    modalTtxTitle6.classList.add('modal-main-ttx-title');
    modalTtxTitle6.textContent = 'Код товара';
    modalTtx4.appendChild(modalTtxTitle6);

    const modalTtxTitle7 = document.createElement('div');
    modalTtxTitle7.classList.add('modal-main-ttx-text');
    modalTtxTitle7.textContent = product.getCount() + " штук";
    modalTtx4.appendChild(modalTtxTitle7);


    modalTtxContainer.appendChild(modalTtx1);
    modalTtxContainer.appendChild(modalTtx2);
    modalTtxContainer.appendChild(modalTtx3);
    modalTtxContainer.appendChild(modalTtx4);

    modalContent2.appendChild(modalTtxContainer);

    modalContentContainer.appendChild(modalContent1);
    modalContentContainer.appendChild(modalContent2);

    modalContent.appendChild(modalContentContainer);

    const modalAction = document.createElement('div');
    modalAction.classList.add('modal-main-action');


    const modalActionContainer = document.createElement('div');
    modalActionContainer.classList.add('modal-main-action');
  
    const modalCountContainer = document.createElement('div');
    modalCountContainer.classList.add('modal-main-count-container');
  
    const countLabel = document.createElement('span');
    countLabel.textContent = 'Количество';
    modalCountContainer.appendChild(countLabel);
  
    const countInput = document.createElement('input');
    countInput.type = 'number';
    countInput.min = '1';
    countInput.max = '100';
    countInput.value = '1';
    modalCountContainer.appendChild(countInput);
  
    const actionContainer = document.createElement('div');
    actionContainer.classList.add('modal-main-action-container');
  
    const buyButtonLink = document.createElement('a');
    buyButtonLink.href = 'cart.html';
  
    const buyButton = document.createElement('button');
    buyButton.type = 'button';
    buyButton.classList.add('btn', 'btn-warning', 'text-white');
    buyButton.textContent = 'Купить';
    buyButton.onclick = function(){product.addToCard(parseInt(countInput.value))};
  
    buyButtonLink.appendChild(buyButton);
    actionContainer.appendChild(buyButtonLink);
  
    const detailsButtonLink = document.createElement('a');
    detailsButtonLink.href = "product.html?" + product.getID();
  
    const detailsButton = document.createElement('button');
    detailsButton.type = 'button';
    detailsButton.classList.add('btn', 'btn-warning', 'text-white');
    detailsButton.textContent = 'Подробнее';
  
    detailsButtonLink.appendChild(detailsButton);
    actionContainer.appendChild(detailsButtonLink);
  
    modalActionContainer.appendChild(modalCountContainer);
    modalActionContainer.appendChild(actionContainer);

    modalAction.appendChild(modalActionContainer);

    modalContent.appendChild(modalAction);

    const modalCloseButton = document.createElement('button');
    modalCloseButton.type = 'button';
    modalCloseButton.classList.add('main-modal-close');
    modalCloseButton.setAttribute('data-bs-dismiss', 'modal');
    modalCloseButton.textContent = '×';
    modalContent.appendChild(modalCloseButton);

    modalDialog.appendChild(modalContent);
    modalContainer.appendChild(modalDialog);

    document.body.appendChild(modalContainer);

    return modalContainer;
}

function renderProductContainer(product) {
    const row = document.createElement('div');
    row.classList.add('row', 'justify-content-center', 'product-main-base-container');
  
    const productImgContainer = document.createElement('div');
    productImgContainer.classList.add('product-img-container');
  
    const productImg = document.createElement('img');
    productImg.src = product.getURLImage();
  
    productImgContainer.appendChild(productImg);
  
    const productContainer = document.createElement('div');
    productContainer.classList.add('product-container');
  
    const productCategory = document.createElement('div');
    productCategory.classList.add('product-category');
  
    const productCategoryIcon = document.createElement('img');
    productCategoryIcon.src = 'file/icon-tag.svg';
  
    const productCategoryText = document.createElement('span');
    productCategoryText.textContent = product.getCategory();
  
    productCategory.appendChild(productCategoryIcon);
    productCategory.appendChild(productCategoryText);
  
    productContainer.appendChild(productCategory);
  
    const productName = document.createElement('h1');
    productName.classList.add('product-name', 'fw-light');
    productName.textContent = product.getName();
  
    productContainer.appendChild(productName);
  
    const productPrice = document.createElement('p');
    productPrice.classList.add('product-price', 'fw-light', 'fs-2');
    productPrice.textContent = formatPrice(product.getPrice());;
  
    productContainer.appendChild(productPrice);
  
    const productTtxContainer = document.createElement('div');
    productTtxContainer.classList.add('product-ttx-container', 'row', 'justify-content-between');
  
    const productTtx = document.createElement('div');
    productTtx.classList.add('product-ttx');
  
    const productTtxText1 = document.createElement('p');
    productTtxText1.textContent = product.getTTX1();
  
    const productTtxText2 = document.createElement('p');
    productTtxText2.textContent = product.getTTX2();
  
    productTtx.appendChild(productTtxText1);
    productTtx.appendChild(productTtxText2);
  
    productTtxContainer.appendChild(productTtx);
  
    const productTtxOtherContainer = document.createElement('div');
    productTtxOtherContainer.classList.add('product-ttx-other-container');
  
    const productBrand = document.createElement('p');
    productBrand.classList.add('product-brand');
    productBrand.innerHTML = '<span>Бренд: </span>' + product.getBrand();
  
    const productCode = document.createElement('p');
    productCode.classList.add('product-code');
    productCode.innerHTML = '<span>Код товара: </span>#' + product.getID();
  
    const productCount = document.createElement('p');
    productCount.classList.add('product-count');
    productCount.innerHTML = '<span>Наличие: </span>' + product.getCount() + ' штук';
  
    productTtxOtherContainer.appendChild(productBrand);
    productTtxOtherContainer.appendChild(productCode);
    productTtxOtherContainer.appendChild(productCount);
  
    productTtxContainer.appendChild(productTtxOtherContainer);
  
    productContainer.appendChild(productTtxContainer);
  
    const productAction = document.createElement('div');
    productAction.classList.add('product-action');
  
    const productActionContainer = document.createElement('div');
    productActionContainer.classList.add('product-action-container');
  
    const productActionQuantityLabel = document.createElement('span');
    productActionQuantityLabel.textContent = 'Количество';
  
    const productActionQuantityInput = document.createElement('input');
    productActionQuantityInput.type = 'number';
    productActionQuantityInput.min = '1';
    productActionQuantityInput.max = '100';
    productActionQuantityInput.value = '1';
  
    productActionContainer.appendChild(productActionQuantityLabel);
    productActionContainer.appendChild(productActionQuantityInput);
  
    const productActionButton = document.createElement('button');
    productActionButton.type = 'button';
    productActionButton.classList.add('btn', 'btn-warning', 'text-white');
    productActionButton.textContent = 'Купить';
    productActionButton.onclick = function(){product.addToCard(parseInt(productActionQuantityInput.value))};

    const productActionLink = document.createElement('a');
    productActionLink.href = 'cart.html';
    productActionLink.appendChild(productActionButton);
  
    productAction.appendChild(productActionContainer);
    productAction.appendChild(productActionLink);
  
    productContainer.appendChild(productAction);
  
    row.appendChild(productImgContainer);
    row.appendChild(productContainer);

    return row;
}

function renderPagination(count, active) {
    const nav = document.createElement('nav');
    nav.classList.add('pagination-category');

    const ul = document.createElement('ul');
    ul.classList.add('pagination', 'justify-content-center');

    for (let i = 1; i <= count; i++) {
        if (i == active) {
            const li1 = document.createElement('li');
            li1.classList.add('page-item', 'disabled');

            const a1 = document.createElement('a');
            a1.classList.add('page-link', 'text-warning');
            a1.href = '#' + i;
            a1.onclick = function(){refrashCatalogPage(i)};
            a1.textContent = i;
            

            li1.appendChild(a1);
            ul.appendChild(li1);
        } else {
            const li2 = document.createElement('li');
            li2.classList.add('page-item');

            const a2 = document.createElement('a');
            a2.classList.add('page-link', 'text-warning');
            a2.onclick = function(){refrashCatalogPage(i)};
            a2.href = '#' + i;
            a2.textContent = i;

            li2.appendChild(a2);
            ul.appendChild(li2);
        }
    }

    nav.appendChild(ul);
    return nav;
}


function formatPrice(price) {
    const formattedPrice = price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
    return `${formattedPrice} руб`;
}

let productCatlogList = [];

function loadProduct() {
    productData.forEach((catalogCategory) => {
        let product = [];
        catalogCategory.Products.forEach((p) => {
            productItem = createSpecialEquipment(
                p.ID,
                p.Name,
                p.URLImage,
                p.Category,
                p.TTX1,
                p.TTX2,
                p.Brand,
                p.Count,
                p.Price
            );
            product.push(productItem);
        });
        category = {"Name" : catalogCategory.Category, "CatID" : catalogCategory.CategoryID, "Link": catalogCategory.CategoryLink,
        "Products": product};
        productCatlogList.push(category);
    });
    console.log(productCatlogList);
}
loadProduct();

function getProductById (id) {
    let product = undefined;
    productCatlogList.forEach((catalogCategory) => {
        catalogCategory.Products.forEach((productItem) => {
            if (productItem.getID() == id) {
                product = productItem;
                return false;
            };
        });
    });
    return product;
}

var categoryInit;
function initCatalogPage(category, page) {
    const maxCountProductInRow = 4;
    const maxCountRow = 2;

    if (page === "") {
        page = 1
    }

    if (category == "") {
        let h1Category = document.querySelectorAll(".h1-product-category")[0];
        h1Category.textContent = "Категория не найдена";
        let breadcrumbCategory = document.querySelectorAll(".breadcrumb-product-category")[0];
        breadcrumbCategory.textContent = "Категория не найдена";
        return true;
    }

    categoryInit = category;

    let products = undefined;
    productCatlogList.forEach((catalogCategory) => {
        if (catalogCategory.CatID === category) {
            category = catalogCategory.Name;
            products = catalogCategory.Products;
            return true;
        }
    });

    if (typeof products == undefined) {
        let h1Category = document.querySelectorAll(".h1-product-category")[0];
        h1Category.textContent = "Категория не найдена";
        let breadcrumbCategory = document.querySelectorAll(".breadcrumb-product-category")[0];
        breadcrumbCategory.textContent = "Категория не найдена";
        return true;
    }


    if (page > Math.ceil(products.length/(maxCountProductInRow*maxCountRow))) {
        page = 1
    }

    let isUsePages = products.length > maxCountProductInRow * maxCountRow;

    let breadcrumbCategory = document.querySelectorAll(".breadcrumb-product-category")[0];
    breadcrumbCategory.textContent = category;

    let h1Category = document.querySelectorAll(".h1-product-category")[0];
    h1Category.textContent = category;

    let container = document.querySelectorAll(".catalog-content-conteiner")[0];
    let containerModal = document.querySelectorAll(".catalog-modal-content-conteiner")[0];

    let counterItemRow = 0;
    let counterRow = 0;

    let row;
    while (products.length - ((page-1)*maxCountProductInRow*maxCountRow)+1 !== counterItemRow + (maxCountProductInRow* (counterRow-1))+1) {
        if (counterItemRow%maxCountProductInRow === 0) {
            if (counterRow >= maxCountRow) {
                break;
            }
            row = renderCardRowContainer();
            container.appendChild(row);
            counterRow++;
            counterItemRow = 0;
        }

        let offset = ((page-1)*maxCountProductInRow*maxCountRow);
        let product = products[((counterRow-1)*maxCountProductInRow) + counterItemRow + offset];

        let card = renderCard(product);
        let modal = renderModal(product);
        row.appendChild(card);
        containerModal.appendChild(modal);
        counterItemRow++;
    };
    
    if (isUsePages) {
        let pagination = renderPagination(Math.ceil(products.length/(maxCountProductInRow*maxCountRow)), page);
        container.appendChild(pagination);
    }
}

function refrashCatalogPage(page) {
    let container = document.querySelectorAll(".catalog-content-conteiner")[0];
    while (container.firstChild) {
        container.removeChild(container.firstChild);
    }
    container = document.querySelectorAll(".catalog-modal-content-conteiner")[0];
    while (container.firstChild) {
        container.removeChild(container.firstChild);
    }
    initCatalogPage(categoryInit, page)
}

function initProductPage(id) {
    console.log(id);
    let product;
    let categoryName;
    let categoryLink;

    productCatlogList.forEach((catalogCategory) => {
        catalogCategory.Products.forEach((productItem) => {
            if (productItem.getID() == id) {
                product = productItem;
                categoryName = catalogCategory.Name;
                categoryLink = catalogCategory.Link;
                return true;
            };
        });
    });

    let container = document.querySelectorAll(".product-content-container")[0];
    let content = renderProductContainer(product);
    container.appendChild(content);

    let breadcrumbCategory = document.querySelectorAll(".breadcrumb-product-category")[0];
    let breadcrumbProduct = document.querySelectorAll(".breadcrumb-product")[0];

    breadcrumbCategory.href = categoryLink;
    breadcrumbCategory.textContent = categoryName;
    breadcrumbProduct.textContent = product.getName();
}

function initHomePage() {
    let product1 = getProductById(1);
    let product2 = getProductById(2);
    let product3 = getProductById(3);
    let product4 = getProductById(4);
    
    let product1Card = renderCard(product1);
    let product2Card = renderCard(product2);
    let product3Card = renderCard(product3);
    let product4Card = renderCard(product4);
  
    let cardContainer = document.querySelectorAll(".card-container")[0];
    cardContainer.appendChild(product1Card);
    cardContainer.appendChild(product2Card);
    cardContainer.appendChild(product3Card);
    cardContainer.appendChild(product4Card);
    
    let product1Modal = renderModal(product1);
    let product2Modal = renderModal(product2);
    let product3Modal = renderModal(product3);
    let product4Modal = renderModal(product4);
  
    let modalContainer = document.querySelectorAll(".modal-container")[0];
    modalContainer.appendChild(product1Modal);
    modalContainer.appendChild(product2Modal);
    modalContainer.appendChild(product3Modal);
    modalContainer.appendChild(product4Modal);
}